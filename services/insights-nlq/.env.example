# ═══════════════════════════════════════════════════════
# Insights NLQ Service - Environment Configuration
# ═══════════════════════════════════════════════════════

# Server Configuration
NODE_ENV=development
PORT_INSIGHTS_NLQ=3009
HOST=0.0.0.0

# Database Configuration (Required)
DATABASE_URL=postgresql://user:password@localhost:5432/teei_csr_platform
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_TIMEOUT=10000

# Redis Cache (Required)
REDIS_URL=redis://localhost:6379
REDIS_KEY_PREFIX=insights-nlq:
REDIS_DEFAULT_TTL=3600

# ClickHouse (Optional - for advanced analytics)
ENABLE_CLICKHOUSE=false
CLICKHOUSE_URL=http://localhost:8123
CLICKHOUSE_DATABASE=teei_analytics

# LLM Provider Configuration (Required - at least one)
# Anthropic (Claude)
ANTHROPIC_API_KEY=sk-ant-...

# OpenAI (GPT)
OPENAI_API_KEY=sk-...

# LLM Settings
LLM_PROVIDER=anthropic
LLM_MODEL=claude-3-5-sonnet-20241022
LLM_MAX_TOKENS=4096
LLM_TEMPERATURE=0

# NATS Event Bus (Optional)
ENABLE_NATS=false
NATS_URL=nats://localhost:4222
NATS_RECONNECT_ATTEMPTS=10

# Feature Flags
ENABLE_CACHE_WARMING=true
ENABLE_PROMETHEUS=true
ENABLE_SAFETY_CHECKS=true

# Performance & Limits
MAX_CONCURRENT_QUERIES=10
QUERY_TIMEOUT=30000
MAX_RESULT_ROWS=10000
ENABLE_QUERY_CACHE=true

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_SKIP_SUCCESSFUL=false

# Security
JWT_SECRET=your-secret-key-here-min-32-chars
CORS_ORIGIN=http://localhost:4321

# SQL Safety - Allowed Table Patterns (comma-separated regex)
ALLOWED_TABLE_PATTERNS=events,metrics,analytics,csrd_metrics,volunteer_activities,sroi_calculations

# SQL Safety - Blocked Keywords (comma-separated)
BLOCKED_SQL_KEYWORDS=DROP,DELETE,TRUNCATE,ALTER,CREATE,INSERT,UPDATE,GRANT,REVOKE,EXEC,EXECUTE

# Logging
LOG_LEVEL=info
LOG_PRETTY=true
