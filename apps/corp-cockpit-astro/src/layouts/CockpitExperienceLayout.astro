---
import LanguageSwitcher from '../components/LanguageSwitcher';

interface NavItem {
  label: string;
  href: string;
  icon: string;
}

interface Breadcrumb {
  label: string;
  href?: string;
}

interface UserInfo {
  name?: string;
  email?: string;
  role?: string;
  status?: 'online' | 'away' | 'busy';
}

interface Props {
  title: string;
  description?: string;
  lang: string;
  companyId?: string;
  breadcrumbs?: Breadcrumb[];
  navItems?: NavItem[];
  user?: UserInfo;
}

const {
  title,
  description = 'TEEI Corporate Cockpit Experience',
  lang,
  companyId,
  breadcrumbs = [],
  navItems: providedNavItems,
  user = {},
} = Astro.props;

const currentPath = Astro.url.pathname;
const baseCockpitPath = companyId ? `/${lang}/cockpit/${companyId}` : `/${lang}`;
const defaultNavItems: NavItem[] = [
  { label: 'Overview', href: baseCockpitPath, icon: 'grid' },
  { label: 'Campaigns', href: `${baseCockpitPath}/campaigns`, icon: 'kanban' },
  { label: 'AI Insights', href: `${baseCockpitPath}/nlq`, icon: 'sparkles' },
  { label: 'Compliance', href: `${baseCockpitPath}/governance`, icon: 'shield' },
  { label: 'Reports', href: `${baseCockpitPath}/reports`, icon: 'file' },
  { label: 'Impact In', href: `${baseCockpitPath}/impact-in`, icon: 'activity' },
];

const navItems = providedNavItems ?? defaultNavItems;
const statusDot = user.status ?? 'online';
const displayName = user.name ?? 'Executive';
const initials = displayName.split(' ').map(n => n[0]).join('').slice(0, 2).toUpperCase();
---

<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <title>{title}</title>
    <style is:global>
      @import '../styles/global.css';
      @import '../components/dashboard/dashboard.css';
    </style>
  </head>
  <body class="experience-body">
    <a href="#experience-main" class="skip-link">Skip to main content</a>
    
    <div class="experience-shell" data-shell>
      <!-- Premium Sidebar -->
      <aside class="experience-sidebar" aria-label="Primary navigation">
        <div class="sidebar-header">
          <button class="sidebar-close" data-sidebar-toggle aria-label="Close navigation">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
          <div class="brand-logo">
            <div class="brand-mark">
              <svg viewBox="0 0 32 32" aria-hidden="true">
                <rect x="4" y="4" width="10" height="10" rx="2" fill="currentColor" opacity="0.9"/>
                <rect x="18" y="4" width="10" height="10" rx="2" fill="currentColor" opacity="0.6"/>
                <rect x="4" y="18" width="10" height="10" rx="2" fill="currentColor" opacity="0.6"/>
                <rect x="18" y="18" width="10" height="10" rx="2" fill="currentColor" opacity="0.3"/>
              </svg>
            </div>
            <div class="brand-text">
              <span class="brand-name">TEEI Cockpit</span>
              <span class="brand-company">{companyId ?? 'Corporate'}</span>
            </div>
          </div>
        </div>

        <nav class="sidebar-nav" aria-label="Main navigation">
          <div class="nav-section">
            <span class="nav-section-label">Navigation</span>
            {navItems.map((item) => {
              const isActive = currentPath === item.href || 
                (item.href !== baseCockpitPath && currentPath.startsWith(item.href));
              return (
                <a
                  href={item.href}
                  class={`nav-link ${isActive ? 'active' : ''}`}
                  aria-current={isActive ? 'page' : undefined}
                >
                  <span class="nav-indicator" aria-hidden="true"></span>
                  <span class="nav-icon" data-icon={item.icon} aria-hidden="true"></span>
                  <span class="nav-label">{item.label}</span>
                </a>
              );
            })}
          </div>
        </nav>

        <div class="sidebar-footer">
          <div class="sidebar-cta">
            <p class="cta-label">Generate Reports</p>
            <p class="cta-description">AI-powered executive briefs</p>
            <button class="btn btn-accent btn-sm">
              <svg viewBox="0 0 20 20" aria-hidden="true">
                <path d="M10 3v14M3 10h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              New Brief
            </button>
          </div>
        </div>
      </aside>

      <!-- Main Content Area -->
      <div class="experience-main">
        <!-- Premium Topbar -->
        <header class="experience-topbar">
          <div class="topbar-left">
            <button class="sidebar-trigger" data-sidebar-toggle aria-label="Open navigation">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
            
            <nav class="breadcrumbs" aria-label="Breadcrumb">
              {breadcrumbs.length > 0 ? (
                breadcrumbs.map((crumb, index) => (
                  <span class="breadcrumb-item">
                    {crumb.href ? (
                      <a href={crumb.href} class="breadcrumb-link">{crumb.label}</a>
                    ) : (
                      <span class="breadcrumb-current">{crumb.label}</span>
                    )}
                    {index < breadcrumbs.length - 1 && (
                      <span class="breadcrumb-separator" aria-hidden="true">/</span>
                    )}
                  </span>
                ))
              ) : (
                <span class="breadcrumb-current">Dashboard</span>
              )}
            </nav>
          </div>

          <div class="topbar-right">
            <button class="command-search" aria-label="Open command palette">
              <svg viewBox="0 0 20 20" aria-hidden="true">
                <circle cx="9" cy="9" r="6" fill="none" stroke="currentColor" stroke-width="1.5"/>
                <path d="M14 14l4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
              <span class="search-placeholder">Search...</span>
              <kbd>⌘K</kbd>
            </button>

            <LanguageSwitcher client:load currentLang={lang} />

            <button class="notification-btn" aria-label="View notifications">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M13.73 21a2 2 0 01-3.46 0" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span class="notification-badge">3</span>
            </button>

            <div class="profile-chip" role="button" tabindex="0" aria-label={`Profile menu for ${displayName}`}>
              <div class="profile-avatar">
                {initials}
                <span class={`status-indicator ${statusDot}`} aria-hidden="true"></span>
              </div>
              <div class="profile-info">
                <span class="profile-name">{displayName}</span>
                <span class="profile-role">{user.role ?? 'Strategy Lead'}</span>
              </div>
              <svg class="profile-chevron" viewBox="0 0 16 16" aria-hidden="true">
                <path d="M4 6l4 4 4-4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          </div>
        </header>

        <!-- Page Content -->
        <main class="experience-content" id="experience-main">
          <slot />
        </main>
      </div>

      <!-- Mobile Overlay -->
      <div class="experience-overlay" data-sidebar-overlay aria-hidden="true"></div>
    </div>

    <script is:inline>
      (() => {
        const shell = document.querySelector('[data-shell]');
        const toggles = document.querySelectorAll('[data-sidebar-toggle]');
        const overlay = document.querySelector('[data-sidebar-overlay]');

        const toggleSidebar = () => {
          shell?.classList.toggle('sidebar-open');
          document.body.classList.toggle('sidebar-open');
        };

        const closeSidebar = () => {
          shell?.classList.remove('sidebar-open');
          document.body.classList.remove('sidebar-open');
        };

        toggles.forEach((btn) => btn.addEventListener('click', toggleSidebar));
        overlay?.addEventListener('click', closeSidebar);

        // Close on escape
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && shell?.classList.contains('sidebar-open')) {
            closeSidebar();
          }
        });
      })();
    </script>
  </body>
</html>

<style>
  /* ==========================================================================
     Experience Shell — Premium Layout Foundation
     ========================================================================== */
  :global(body) {
    background: var(--color-background);
    color: var(--color-text-primary);
    font-family: var(--font-family);
    overflow-x: hidden;
  }

  :global(body.sidebar-open) {
    overflow: hidden;
  }

  .experience-shell {
    display: grid;
    grid-template-columns: var(--sidebar-width-desktop) 1fr;
    min-height: 100vh;
    transition: grid-template-columns var(--duration-normal) var(--ease-out);
  }

  /* ==========================================================================
     Sidebar — Teal Scaffold with Gold Accents
     ========================================================================== */
  .experience-sidebar {
    background: linear-gradient(180deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
    color: rgba(255, 255, 255, 0.9);
    display: flex;
    flex-direction: column;
    position: sticky;
    top: 0;
    height: 100vh;
    z-index: 20;
    box-shadow: 
      inset -1px 0 0 rgba(255, 255, 255, 0.06),
      4px 0 24px rgba(0, 57, 63, 0.15);
  }

  .sidebar-header {
    padding: var(--space-6) var(--space-5);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  }

  .sidebar-close {
    display: none;
    position: absolute;
    top: var(--space-4);
    right: var(--space-4);
    width: 36px;
    height: 36px;
    border-radius: var(--radius-md);
    border: 1px solid rgba(255, 255, 255, 0.15);
    background: rgba(255, 255, 255, 0.05);
    color: rgba(255, 255, 255, 0.8);
    align-items: center;
    justify-content: center;
    transition: all var(--duration-fast) var(--ease-out);
  }

  .sidebar-close:hover {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
  }

  .sidebar-close svg {
    width: 18px;
    height: 18px;
  }

  .brand-logo {
    display: flex;
    align-items: center;
    gap: var(--space-4);
  }

  .brand-mark {
    width: 44px;
    height: 44px;
    border-radius: var(--radius-lg);
    background: rgba(255, 255, 255, 0.1);
    display: grid;
    place-items: center;
    color: var(--color-accent);
    flex-shrink: 0;
  }

  .brand-mark svg {
    width: 26px;
    height: 26px;
  }

  .brand-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
    min-width: 0;
  }

  .brand-name {
    font-size: var(--text-sm);
    font-weight: var(--font-weight-semibold);
    letter-spacing: var(--tracking-wide);
    color: #fff;
  }

  .brand-company {
    font-size: var(--text-xs);
    color: rgba(255, 255, 255, 0.6);
    text-transform: uppercase;
    letter-spacing: var(--tracking-caps);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Navigation */
  .sidebar-nav {
    flex: 1;
    padding: var(--space-5);
    overflow-y: auto;
  }

  .nav-section {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
  }

  .nav-section-label {
    font-size: var(--text-xs);
    font-weight: var(--font-weight-medium);
    text-transform: uppercase;
    letter-spacing: var(--tracking-caps);
    color: rgba(255, 255, 255, 0.4);
    padding: var(--space-3) var(--space-3) var(--space-2);
  }

  .nav-link {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3) var(--space-3);
    border-radius: var(--radius-lg);
    color: rgba(255, 255, 255, 0.75);
    text-decoration: none;
    font-size: var(--text-sm);
    font-weight: var(--font-weight-medium);
    position: relative;
    transition: all var(--duration-fast) var(--ease-out);
  }

  .nav-indicator {
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 3px;
    height: 24px;
    border-radius: 0 var(--radius-pill) var(--radius-pill) 0;
    background: var(--color-accent);
    opacity: 0;
    transition: opacity var(--duration-fast) var(--ease-out);
  }

  .nav-link:hover {
    background: rgba(255, 255, 255, 0.06);
    color: #fff;
  }

  .nav-link.active {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
  }

  .nav-link.active .nav-indicator {
    opacity: 1;
    box-shadow: 0 0 12px rgba(186, 143, 90, 0.5);
  }

  .nav-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .nav-icon::before {
    content: '';
    width: 20px;
    height: 20px;
    display: block;
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
    background-color: currentColor;
  }

  /* Icon masks */
  .nav-icon[data-icon='grid']::before {
    mask-image: url('data:image/svg+xml,%3Csvg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" xmlns="http://www.w3.org/2000/svg"%3E%3Crect x="3" y="3" width="7" height="7" rx="1"/%3E%3Crect x="14" y="3" width="7" height="7" rx="1"/%3E%3Crect x="14" y="14" width="7" height="7" rx="1"/%3E%3Crect x="3" y="14" width="7" height="7" rx="1"/%3E%3C/svg%3E');
  }

  .nav-icon[data-icon='kanban']::before {
    mask-image: url('data:image/svg+xml,%3Csvg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" xmlns="http://www.w3.org/2000/svg"%3E%3Crect x="4" y="4" width="4" height="16" rx="1"/%3E%3Crect x="10" y="4" width="4" height="10" rx="1"/%3E%3Crect x="16" y="4" width="4" height="14" rx="1"/%3E%3C/svg%3E');
  }

  .nav-icon[data-icon='sparkles']::before {
    mask-image: url('data:image/svg+xml,%3Csvg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M12 3v2M12 19v2M3 12h2M19 12h2M5.6 5.6l1.4 1.4M17 17l1.4 1.4M5.6 18.4l1.4-1.4M17 7l1.4-1.4"/%3E%3Ccircle cx="12" cy="12" r="4"/%3E%3C/svg%3E');
  }

  .nav-icon[data-icon='shield']::before {
    mask-image: url('data:image/svg+xml,%3Csvg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/%3E%3Cpath d="M9 12l2 2 4-4"/%3E%3C/svg%3E');
  }

  .nav-icon[data-icon='file']::before {
    mask-image: url('data:image/svg+xml,%3Csvg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/%3E%3Cpath d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/%3E%3C/svg%3E');
  }

  .nav-icon[data-icon='activity']::before {
    mask-image: url('data:image/svg+xml,%3Csvg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M22 12h-4l-3 9L9 3l-3 9H2"/%3E%3C/svg%3E');
  }

  /* Sidebar Footer CTA */
  .sidebar-footer {
    padding: var(--space-5);
    border-top: 1px solid rgba(255, 255, 255, 0.08);
  }

  .sidebar-cta {
    background: rgba(255, 255, 255, 0.06);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
  }

  .cta-label {
    font-size: var(--text-sm);
    font-weight: var(--font-weight-semibold);
    color: #fff;
    margin-bottom: var(--space-1);
  }

  .cta-description {
    font-size: var(--text-xs);
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: var(--space-4);
  }

  .sidebar-cta .btn {
    width: 100%;
    justify-content: center;
  }

  .sidebar-cta .btn svg {
    width: 16px;
    height: 16px;
  }

  /* ==========================================================================
     Topbar — Translucent with Blur
     ========================================================================== */
  .experience-main {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    background: var(--color-background);
  }

  .experience-topbar {
    position: sticky;
    top: 0;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-4);
    padding: var(--space-4) var(--space-6);
    height: var(--topbar-height);
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(var(--topbar-blur));
    border-bottom: 1px solid var(--color-border-subtle);
    box-shadow: 0 1px 3px rgba(0, 57, 63, 0.04);
  }

  .topbar-left {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    flex: 1;
    min-width: 0;
  }

  .sidebar-trigger {
    display: none;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    background: var(--color-surface);
    color: var(--color-text-secondary);
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all var(--duration-fast) var(--ease-out);
  }

  .sidebar-trigger:hover {
    background: var(--color-surface-alt);
    color: var(--color-text-primary);
  }

  .sidebar-trigger svg {
    width: 20px;
    height: 20px;
  }

  /* Breadcrumbs */
  .breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    min-width: 0;
  }

  .breadcrumb-item {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }

  .breadcrumb-link,
  .breadcrumb-current {
    font-size: var(--text-xs);
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-caps);
    white-space: nowrap;
  }

  .breadcrumb-link {
    color: var(--color-text-tertiary);
    text-decoration: none;
    transition: color var(--duration-fast) var(--ease-out);
  }

  .breadcrumb-link:hover {
    color: var(--color-text-secondary);
  }

  .breadcrumb-current {
    color: var(--color-primary);
  }

  .breadcrumb-separator {
    color: var(--color-border-strong);
  }

  /* Topbar Right Actions */
  .topbar-right {
    display: flex;
    align-items: center;
    gap: var(--space-3);
  }

  .command-search {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2) var(--space-4);
    min-width: 200px;
    height: 40px;
    border-radius: var(--radius-pill);
    border: 1px solid var(--color-border);
    background: var(--color-surface);
    color: var(--color-text-tertiary);
    font-size: var(--text-sm);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-out);
  }

  .command-search:hover {
    border-color: var(--color-border-strong);
    background: var(--color-surface-alt);
  }

  .command-search svg {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  .search-placeholder {
    flex: 1;
  }

  .command-search kbd {
    font-size: var(--text-xs);
    font-family: var(--font-family);
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    background: var(--color-muted);
    border: 1px solid var(--color-border-subtle);
    color: var(--color-text-tertiary);
  }

  .notification-btn {
    position: relative;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    background: var(--color-surface);
    color: var(--color-text-secondary);
    display: grid;
    place-items: center;
    transition: all var(--duration-fast) var(--ease-out);
  }

  .notification-btn:hover {
    background: var(--color-surface-alt);
    color: var(--color-text-primary);
  }

  .notification-btn svg {
    width: 20px;
    height: 20px;
  }

  .notification-badge {
    position: absolute;
    top: 6px;
    right: 6px;
    min-width: 16px;
    height: 16px;
    padding: 0 4px;
    border-radius: var(--radius-pill);
    background: var(--color-accent);
    color: var(--color-text-on-accent);
    font-size: 10px;
    font-weight: var(--font-weight-bold);
    display: grid;
    place-items: center;
    line-height: 1;
  }

  /* Profile Chip */
  .profile-chip {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-1) var(--space-3) var(--space-1) var(--space-1);
    border-radius: var(--radius-pill);
    border: 1px solid var(--color-border);
    background: var(--color-surface);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-out);
  }

  .profile-chip:hover {
    background: var(--color-surface-alt);
    border-color: var(--color-border-strong);
  }

  .profile-avatar {
    position: relative;
    width: 36px;
    height: 36px;
    border-radius: var(--radius-pill);
    background: var(--color-primary);
    color: var(--color-text-on-primary);
    font-size: var(--text-xs);
    font-weight: var(--font-weight-bold);
    display: grid;
    place-items: center;
  }

  .status-indicator {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 10px;
    height: 10px;
    border-radius: var(--radius-pill);
    border: 2px solid var(--color-surface);
    background: var(--color-success);
  }

  .status-indicator.away {
    background: var(--color-warning);
  }

  .status-indicator.busy {
    background: var(--color-error);
  }

  .profile-info {
    display: flex;
    flex-direction: column;
    line-height: 1.2;
  }

  .profile-name {
    font-size: var(--text-sm);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
  }

  .profile-role {
    font-size: var(--text-xs);
    color: var(--color-text-tertiary);
  }

  .profile-chevron {
    width: 16px;
    height: 16px;
    color: var(--color-text-tertiary);
    transition: transform var(--duration-fast) var(--ease-out);
  }

  .profile-chip:hover .profile-chevron {
    transform: translateY(2px);
  }

  /* ==========================================================================
     Content Area
     ========================================================================== */
  .experience-content {
    flex: 1;
    padding: var(--space-6);
    max-width: var(--content-max-width);
    width: 100%;
    margin: 0 auto;
  }

  /* ==========================================================================
     Mobile Overlay
     ========================================================================== */
  .experience-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 20, 25, 0.6);
    backdrop-filter: blur(4px);
    opacity: 0;
    pointer-events: none;
    z-index: 15;
    transition: opacity var(--duration-normal) var(--ease-out);
  }

  /* ==========================================================================
     Responsive Behaviors
     ========================================================================== */
  @media (max-width: 1279px) {
    .experience-shell {
      grid-template-columns: var(--sidebar-width-tablet) 1fr;
    }

    .nav-label,
    .brand-text,
    .sidebar-cta {
      display: none;
    }

    .sidebar-header {
      padding: var(--space-4);
    }

    .brand-logo {
      justify-content: center;
    }

    .sidebar-nav {
      padding: var(--space-3);
    }

    .nav-section-label {
      display: none;
    }

    .nav-link {
      justify-content: center;
      padding: var(--space-3);
    }

    .nav-indicator {
      display: none;
    }

    .sidebar-footer {
      padding: var(--space-3);
    }
  }

  @media (max-width: 1024px) {
    .experience-shell {
      grid-template-columns: 1fr;
    }

    .experience-sidebar {
      position: fixed;
      inset: 0 auto 0 0;
      width: var(--sidebar-overlay-mobile);
      transform: translateX(-100%);
      transition: transform var(--duration-normal) var(--ease-out);
    }

    .experience-shell.sidebar-open .experience-sidebar {
      transform: translateX(0);
    }

    .experience-overlay {
      display: block;
    }

    .experience-shell.sidebar-open .experience-overlay {
      opacity: 1;
      pointer-events: auto;
    }

    .sidebar-close {
      display: inline-flex;
    }

    .sidebar-trigger {
      display: inline-flex;
    }

    /* Restore full sidebar on mobile when open */
    .nav-label,
    .brand-text,
    .sidebar-cta {
      display: block;
    }

    .brand-logo {
      justify-content: flex-start;
    }

    .nav-link {
      justify-content: flex-start;
      padding: var(--space-3);
    }

    .nav-indicator {
      display: block;
    }

    .nav-section-label {
      display: block;
    }
  }

  @media (max-width: 768px) {
    .command-search {
      display: none;
    }

    .profile-info {
      display: none;
    }

    .profile-chip {
      padding: var(--space-1);
    }
  }

  @media (max-width: 640px) {
    .experience-topbar {
      padding: var(--space-3) var(--space-4);
    }

    .experience-content {
      padding: var(--space-4);
    }
  }
</style>
