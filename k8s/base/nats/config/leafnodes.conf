# Leafnode Configuration for Cross-Region Connectivity
#
# Leafnodes enable message routing between geographically distributed NATS clusters
# without full mesh clustering (which has latency/stability issues across regions)
#
# Architecture:
# - US cluster: Primary, connects to EU via leafnode
# - EU cluster: DR/GDPR, connects to US via leafnode
# - Bidirectional connectivity for stream mirroring

leafnodes {
  # Port for accepting leafnode connections
  port: 7422

  # Authorization for incoming leafnode connections
  authorization {
    user: $NATS_LEAFNODE_USER
    password: $NATS_LEAFNODE_PASSWORD
    timeout: 5
  }

  # Remotes: other clusters to connect to as a leafnode
  # This section is region-specific and configured via kustomize overlays

  # For US region (us-east-1):
  # remotes = [
  #   {
  #     url: "nats-leaf://nats-lb.eu-central-1.example.com:7422"
  #     account: "APP"
  #
  #     # Authentication options:
  #     # Option 1: User/password
  #     # user: "leafnode_user"
  #     # password: "CHANGE_ME_LEAFNODE_PASSWORD"
  #
  #     # Option 2: Credentials file (JWT + NKEY) - RECOMMENDED
  #     credentials: "/etc/nats-secret/leafnode.creds"
  #
  #     # TLS configuration (recommended for production)
  #     # tls {
  #     #   cert_file: "/etc/nats-tls/leafnode-cert.pem"
  #     #   key_file: "/etc/nats-tls/leafnode-key.pem"
  #     #   ca_file: "/etc/nats-tls/ca.pem"
  #     # }
  #   }
  # ]

  # For EU region (eu-central-1):
  # remotes = [
  #   {
  #     url: "nats-leaf://nats-lb.us-east-1.example.com:7422"
  #     account: "APP"
  #     credentials: "/etc/nats-secret/leafnode.creds"
  #   }
  # ]

  # Placeholder - actual configuration via kustomize overlays
  remotes = []
}

# Leafnode Notes:
# 1. Leafnodes do NOT require full cluster membership
# 2. Lower latency tolerance than clustering (500ms+ WAN is OK)
# 3. Supports subject filtering for bandwidth optimization
# 4. Enables JetStream stream mirroring across regions
# 5. Automatic reconnection on network failures
