# TEMPLATE: Analytics Service Secrets
# Metrics, dashboards, and data warehouse integration
# DO NOT commit actual secret values

apiVersion: v1
kind: Secret
metadata:
  name: teei-analytics-secrets
  namespace: NAMESPACE_PLACEHOLDER
  labels:
    app: teei-analytics
    component: analytics
    managed-by: sealed-secrets
type: Opaque
stringData:
  # Primary database for analytics queries
  DATABASE_URL: "postgresql://postgres:PLACEHOLDER_PASSWORD@postgres-service:5432/teei_csr"

  # Analytics read replica (recommended for heavy queries)
  ANALYTICS_DB_URL: "postgresql://postgres:PLACEHOLDER_PASSWORD@postgres-analytics-replica:5432/teei_csr"

  # ClickHouse for OLAP queries (if using)
  CLICKHOUSE_URL: "https://clickhouse-service:8123"
  CLICKHOUSE_USERNAME: "analytics_user"
  CLICKHOUSE_PASSWORD: "PLACEHOLDER_CLICKHOUSE_PASSWORD"
  CLICKHOUSE_DATABASE: "teei_analytics"

  # Redis for caching dashboard data
  REDIS_URL: "redis://redis-service:6379"
  REDIS_PASSWORD: "PLACEHOLDER_REDIS_PASSWORD"

  # Data warehouse credentials (BigQuery, Snowflake, etc.)
  DW_TYPE: "bigquery"  # or "snowflake", "redshift"
  DW_PROJECT_ID: "PLACEHOLDER_GCP_PROJECT_ID"
  DW_DATASET: "teei_analytics_staging"
  DW_CREDENTIALS: "PLACEHOLDER_DW_SERVICE_ACCOUNT_JSON"

  # S3 for data lake exports
  AWS_ACCESS_KEY_ID: "PLACEHOLDER_AWS_ACCESS_KEY"
  AWS_SECRET_ACCESS_KEY: "PLACEHOLDER_AWS_SECRET_KEY"
  S3_BUCKET: "teei-analytics-exports-staging"
  S3_REGION: "us-west-2"

  # API keys for external analytics integrations
  MIXPANEL_API_KEY: "PLACEHOLDER_MIXPANEL_API_KEY"
  SEGMENT_WRITE_KEY: "PLACEHOLDER_SEGMENT_WRITE_KEY"
  AMPLITUDE_API_KEY: "PLACEHOLDER_AMPLITUDE_API_KEY"

  # OpenTelemetry collector credentials
  OTEL_EXPORTER_OTLP_ENDPOINT: "https://otel-collector:4318"
  OTEL_EXPORTER_OTLP_HEADERS: "Authorization=Bearer PLACEHOLDER_OTEL_TOKEN"

  # Grafana API key for dashboard updates
  GRAFANA_API_KEY: "PLACEHOLDER_GRAFANA_API_KEY"
  GRAFANA_URL: "https://grafana.teei.example.com"

  # Report generation encryption key
  REPORT_ENCRYPTION_KEY: "PLACEHOLDER_REPORT_ENCRYPTION_KEY"

---
# Analytics Security:
# - Use read-only database credentials where possible
# - Limit data warehouse access to necessary datasets
# - Enable query logging and monitoring
# - Set query timeout limits to prevent resource exhaustion
# - Encrypt sensitive analytics exports
# - Audit dashboard access regularly
