{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      },
      {
        "datasource": "Prometheus",
        "enable": true,
        "expr": "ALERTS{alertname=~\"SLO.*\"}",
        "iconColor": "red",
        "name": "SLO Alerts",
        "step": "60s",
        "tagKeys": "alertname,severity",
        "textFormat": "{{ alertname }}: {{ service }}",
        "titleFormat": "SLO Alert"
      },
      {
        "datasource": "Prometheus",
        "enable": true,
        "expr": "ALERTS{alertname=~\"DeploymentBlocked.*\"}",
        "iconColor": "orange",
        "name": "Deployment Blocks",
        "step": "60s",
        "tagKeys": "alertname",
        "textFormat": "Deployment blocked: {{ $labels.reason }}",
        "titleFormat": "Deployment Gate"
      }
    ]
  },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "datasource": "Prometheus",
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "options": {
        "content": "# SLO Overview Dashboard\n\nService Level Objectives (SLOs) and Error Budget tracking for TEEI CSR Platform.\n\n**Legend**: ðŸŸ¢ Green (>50% budget) | ðŸŸ¡ Yellow (20-50%) | ðŸŸ  Orange (10-20%) | ðŸ”´ Red (<10%)\n\n**Deployment Gate**: Deployments are **BLOCKED** when SLOs are breaching or error budget is exhausted.",
        "mode": "markdown"
      },
      "pluginVersion": "8.0.0",
      "title": "Overview",
      "type": "text"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "red", "value": null},
              {"color": "orange", "value": 10},
              {"color": "yellow", "value": 20},
              {"color": "green", "value": 50}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 0,
        "y": 2
      },
      "id": 2,
      "options": {
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "error_budget:api_gateway:remaining_ratio * 100",
          "refId": "A"
        }
      ],
      "title": "API Gateway Error Budget",
      "type": "gauge"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "red", "value": null},
              {"color": "orange", "value": 10},
              {"color": "yellow", "value": 20},
              {"color": "green", "value": 50}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 6,
        "y": 2
      },
      "id": 3,
      "options": {
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "error_budget:reporting_service:remaining_ratio * 100",
          "refId": "A"
        }
      ],
      "title": "Reporting Service Error Budget",
      "type": "gauge"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "red", "value": null},
              {"color": "orange", "value": 10},
              {"color": "yellow", "value": 20},
              {"color": "green", "value": 50}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 2
      },
      "id": 4,
      "options": {
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "text": {}
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "error_budget:data_residency:remaining_ratio * 100",
          "refId": "A"
        }
      ],
      "title": "Data Residency Error Budget (GDPR)",
      "type": "gauge"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [
            {"options": {"0": {"color": "green", "text": "ALLOWED"}}, "type": "value"},
            {"options": {"1": {"color": "red", "text": "BLOCKED"}}, "type": "value"}
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "red", "value": 1}
            ]
          },
          "unit": "none"
        }
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 2
      },
      "id": 5,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "text": {},
        "textMode": "value_and_name"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "(\n  sli:availability:api_gateway:ratio < 0.999\n  or sli:availability:reporting_service:ratio < 0.995\n  or sli:availability:data_residency:ratio < 0.9999\n  or burn_rate:api_gateway:1h > 14.4\n  or burn_rate:reporting_service:1h > 14.4\n  or burn_rate:data_residency:1h > 14.4\n) > 0",
          "refId": "A"
        }
      ],
      "title": "Deployment Gate Status",
      "type": "stat"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "Availability %",
            "axisPlacement": "auto",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineWidth": 2,
            "pointSize": 5
          },
          "decimals": 2,
          "max": 100,
          "min": 99,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "red", "value": null},
              {"color": "yellow", "value": 99.5},
              {"color": "green", "value": 99.9}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 0,
        "y": 10
      },
      "id": 6,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "min"],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi"
        }
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sli:availability:api_gateway:ratio * 100",
          "legendFormat": "API Gateway (99.9% SLO)",
          "refId": "A"
        },
        {
          "expr": "sli:availability:reporting_service:ratio * 100",
          "legendFormat": "Reporting Service (99.5% SLO)",
          "refId": "B"
        },
        {
          "expr": "sli:availability:data_residency:ratio * 100",
          "legendFormat": "Data Residency (99.99% SLO)",
          "refId": "C"
        }
      ],
      "title": "Availability SLI (5m rolling)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "Latency (ms)",
            "axisPlacement": "auto",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineWidth": 2,
            "pointSize": 5
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 200},
              {"color": "red", "value": 500}
            ]
          },
          "unit": "ms"
        }
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 12,
        "y": 10
      },
      "id": 7,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "max"],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi"
        }
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sli:latency:api_gateway:p95_ms",
          "legendFormat": "API Gateway p95 (<200ms SLO)",
          "refId": "A"
        },
        {
          "expr": "sli:latency:api_gateway:p99_ms",
          "legendFormat": "API Gateway p99 (<500ms SLO)",
          "refId": "B"
        },
        {
          "expr": "sli:latency:genai_reporting:p95_ms",
          "legendFormat": "GenAI Reporting p95 (<5000ms SLO)",
          "refId": "C"
        }
      ],
      "title": "Latency SLI (5m rolling)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "Burn Rate (x)",
            "axisPlacement": "auto",
            "fillOpacity": 20,
            "gradientMode": "none",
            "lineWidth": 2,
            "pointSize": 5
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 6},
              {"color": "red", "value": 14.4}
            ]
          },
          "unit": "none"
        }
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 0,
        "y": 20
      },
      "id": 8,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "max"],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi"
        }
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "burn_rate:api_gateway:1h",
          "legendFormat": "API Gateway (1h fast burn, 14.4x threshold)",
          "refId": "A"
        },
        {
          "expr": "burn_rate:api_gateway:6h",
          "legendFormat": "API Gateway (6h slow burn, 6x threshold)",
          "refId": "B"
        },
        {
          "expr": "burn_rate:reporting_service:1h",
          "legendFormat": "Reporting Service (1h fast burn)",
          "refId": "C"
        },
        {
          "expr": "burn_rate:data_residency:1h",
          "legendFormat": "Data Residency (1h fast burn)",
          "refId": "D"
        }
      ],
      "title": "Error Budget Burn Rate (Multi-Window)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "Error Rate %",
            "axisPlacement": "auto",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineWidth": 2,
            "pointSize": 5
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 0.001},
              {"color": "red", "value": 0.01}
            ]
          },
          "unit": "percentunit"
        }
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 12,
        "y": 20
      },
      "id": 9,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "max"],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi"
        }
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sli:error_rate:5xx:ratio",
          "legendFormat": "5xx Errors (<0.1% SLO)",
          "refId": "A"
        },
        {
          "expr": "sli:error_rate:4xx:ratio",
          "legendFormat": "4xx Errors (non-auth, <1% SLO)",
          "refId": "B"
        }
      ],
      "title": "Error Rate SLI (5m rolling)",
      "type": "timeseries"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "displayMode": "auto"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 99},
              {"color": "red", "value": 99.9}
            ]
          }
        }
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 0,
        "y": 30
      },
      "id": 10,
      "options": {
        "showHeader": true
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sli:availability:api_gateway:ratio_by_region * 100",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "title": "Regional SLO Status (API Gateway)",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "__name__": true
            },
            "indexByName": {},
            "renameByName": {
              "Value": "Availability %",
              "region": "Region"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [
            {"options": {"0": {"color": "green", "text": "No violations"}}, "type": "value"},
            {"options": {"from": 1, "result": {"color": "red", "text": "VIOLATION DETECTED"}, "to": 99999}, "type": "range"}
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "red", "value": 1}
            ]
          },
          "unit": "none"
        }
      },
      "gridPos": {
        "h": 10,
        "w": 12,
        "x": 12,
        "y": 30
      },
      "id": 11,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "text": {},
        "textMode": "value_and_name"
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sli:gdpr_violations:count",
          "refId": "A"
        }
      ],
      "title": "GDPR Violations (Zero Tolerance)",
      "type": "stat"
    },
    {
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisLabel": "Success Rate %",
            "axisPlacement": "auto",
            "fillOpacity": 10,
            "gradientMode": "none",
            "lineWidth": 2,
            "pointSize": 5
          },
          "max": 100,
          "min": 95,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "red", "value": null},
              {"color": "yellow", "value": 99},
              {"color": "green", "value": 99.5}
            ]
          },
          "unit": "percent"
        }
      },
      "gridPos": {
        "h": 10,
        "w": 24,
        "x": 0,
        "y": 40
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "min"],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi"
        }
      },
      "pluginVersion": "8.0.0",
      "targets": [
        {
          "expr": "sli:business:report_generation_success:ratio * 100",
          "legendFormat": "Report Generation (>99% SLO)",
          "refId": "A"
        },
        {
          "expr": "sli:business:sse_connection_stability:ratio * 100",
          "legendFormat": "SSE Connection Stability (>99.5% SLO)",
          "refId": "B"
        },
        {
          "expr": "sli:business:export_success:ratio * 100",
          "legendFormat": "Data Export (>99% SLO)",
          "refId": "C"
        }
      ],
      "title": "Business SLI (5m rolling)",
      "type": "timeseries"
    }
  ],
  "refresh": "1m",
  "schemaVersion": 27,
  "style": "dark",
  "tags": ["slo", "error-budget", "deployment-gate"],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": ["10s", "30s", "1m", "5m", "15m", "30m", "1h"]
  },
  "timezone": "utc",
  "title": "SLO Overview - TEEI CSR Platform",
  "uid": "slo-overview",
  "version": 1
}
