{
  "dashboard": {
    "title": "SLO Overview - Error Budget & Burn Rate",
    "tags": ["teei", "slo", "error-budget", "sre", "observability"],
    "timezone": "utc",
    "schemaVersion": 16,
    "version": 1,
    "refresh": "30s",
    "editable": true,
    "panels": [
      {
        "id": 1,
        "title": "SLO Compliance Overview",
        "type": "stat",
        "gridPos": {
          "h": 6,
          "w": 24,
          "x": 0,
          "y": 0
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "(1 - (sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[30d])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[30d])) by (service))) * 100",
            "legendFormat": "{{ service }}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "decimals": 3,
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {
                  "color": "red",
                  "value": null
                },
                {
                  "color": "yellow",
                  "value": 99.0
                },
                {
                  "color": "green",
                  "value": 99.5
                }
              ]
            },
            "links": [
              {
                "title": "View Runbook",
                "url": "/docs/runbooks/${__field.labels.service}.md"
              }
            ]
          },
          "overrides": []
        },
        "options": {
          "orientation": "horizontal",
          "textMode": "value_and_name",
          "colorMode": "background",
          "graphMode": "area",
          "justifyMode": "center"
        }
      },
      {
        "id": 2,
        "title": "Error Rate vs SLO Target (99.5%)",
        "type": "graph",
        "gridPos": {
          "h": 9,
          "w": 12,
          "x": 0,
          "y": 6
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "(sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[$__rate_interval])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[$__rate_interval])) by (service)) * 100",
            "legendFormat": "{{ service }} - Error Rate",
            "refId": "A"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(0.5)",
            "legendFormat": "SLO Target (0.5%)",
            "refId": "B"
          }
        ],
        "yAxes": [
          {
            "label": "Error Rate %",
            "format": "percent",
            "decimals": 2
          }
        ],
        "thresholds": [
          {
            "value": 0.5,
            "colorMode": "critical",
            "op": "gt",
            "fill": true,
            "line": true
          }
        ],
        "alert": {
          "conditions": [
            {
              "evaluator": {
                "params": [0.5],
                "type": "gt"
              },
              "operator": {
                "type": "and"
              },
              "query": {
                "params": ["A", "5m", "now"]
              },
              "reducer": {
                "params": [],
                "type": "avg"
              },
              "type": "query"
            }
          ],
          "name": "SLO Error Rate Exceeded"
        }
      },
      {
        "id": 3,
        "title": "Error Budget Remaining (30-day window)",
        "type": "bargauge",
        "gridPos": {
          "h": 9,
          "w": 12,
          "x": 12,
          "y": 6
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "((0.005 - (sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[30d])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[30d])) by (service))) / 0.005) * 100",
            "legendFormat": "{{ service }}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "min": 0,
            "max": 100,
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {
                  "color": "red",
                  "value": null
                },
                {
                  "color": "orange",
                  "value": 10
                },
                {
                  "color": "yellow",
                  "value": 25
                },
                {
                  "color": "green",
                  "value": 50
                }
              ]
            }
          }
        },
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "showUnfilled": true
        }
      },
      {
        "id": 4,
        "title": "1-Hour Burn Rate (Fast Burn Alert)",
        "type": "graph",
        "gridPos": {
          "h": 8,
          "w": 8,
          "x": 0,
          "y": 15
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "((sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[1h])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[1h])) by (service)) / 0.005)",
            "legendFormat": "{{ service }}",
            "refId": "A"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(14.4)",
            "legendFormat": "Critical (14.4x) - 2% budget in 1hr",
            "refId": "B"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(6)",
            "legendFormat": "Warning (6x) - 5% budget in 1hr",
            "refId": "C"
          }
        ],
        "yAxes": [
          {
            "label": "Burn Rate Multiplier",
            "format": "short",
            "decimals": 1
          }
        ],
        "thresholds": [
          {
            "value": 6,
            "colorMode": "warning"
          },
          {
            "value": 14.4,
            "colorMode": "critical"
          }
        ]
      },
      {
        "id": 5,
        "title": "6-Hour Burn Rate (Medium Burn Alert)",
        "type": "graph",
        "gridPos": {
          "h": 8,
          "w": 8,
          "x": 8,
          "y": 15
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "((sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[6h])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[6h])) by (service)) / 0.005)",
            "legendFormat": "{{ service }}",
            "refId": "A"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(6)",
            "legendFormat": "Critical (6x) - 5% budget in 6hr",
            "refId": "B"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(3)",
            "legendFormat": "Warning (3x) - 10% budget in 6hr",
            "refId": "C"
          }
        ],
        "yAxes": [
          {
            "label": "Burn Rate Multiplier",
            "format": "short",
            "decimals": 1
          }
        ],
        "thresholds": [
          {
            "value": 3,
            "colorMode": "warning"
          },
          {
            "value": 6,
            "colorMode": "critical"
          }
        ]
      },
      {
        "id": 6,
        "title": "7-Day Burn Rate (Slow Burn Alert)",
        "type": "graph",
        "gridPos": {
          "h": 8,
          "w": 8,
          "x": 16,
          "y": 15
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "((sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[7d])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[7d])) by (service)) / 0.005)",
            "legendFormat": "{{ service }}",
            "refId": "A"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(1)",
            "legendFormat": "Critical (1x) - Budget at risk",
            "refId": "B"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(0.5)",
            "legendFormat": "Target (0.5x) - Sustainable rate",
            "refId": "C"
          }
        ],
        "yAxes": [
          {
            "label": "Burn Rate Multiplier",
            "format": "short",
            "decimals": 2
          }
        ],
        "thresholds": [
          {
            "value": 1,
            "colorMode": "critical"
          }
        ]
      },
      {
        "id": 7,
        "title": "P95 Latency vs SLO (500ms)",
        "type": "graph",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 23
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{service=~\"$service\"}[$__rate_interval])) by (le, service)) * 1000",
            "legendFormat": "{{ service }} - P95",
            "refId": "A"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(500)",
            "legendFormat": "SLO Target (500ms)",
            "refId": "B"
          }
        ],
        "yAxes": [
          {
            "label": "Latency (ms)",
            "format": "ms",
            "decimals": 0
          }
        ],
        "thresholds": [
          {
            "value": 500,
            "colorMode": "warning"
          },
          {
            "value": 1000,
            "colorMode": "critical"
          }
        ]
      },
      {
        "id": 8,
        "title": "P99 Latency vs SLO (1000ms)",
        "type": "graph",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 12,
          "y": 23
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "histogram_quantile(0.99, sum(rate(http_request_duration_seconds_bucket{service=~\"$service\"}[$__rate_interval])) by (le, service)) * 1000",
            "legendFormat": "{{ service }} - P99",
            "refId": "A"
          },
          {
            "datasource": "Prometheus",
            "expr": "vector(1000)",
            "legendFormat": "SLO Target (1000ms)",
            "refId": "B"
          }
        ],
        "yAxes": [
          {
            "label": "Latency (ms)",
            "format": "ms",
            "decimals": 0
          }
        ],
        "thresholds": [
          {
            "value": 1000,
            "colorMode": "warning"
          },
          {
            "value": 2000,
            "colorMode": "critical"
          }
        ]
      },
      {
        "id": 9,
        "title": "Request Volume by Service",
        "type": "graph",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 31
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "sum(rate(http_requests_total{service=~\"$service\"}[$__rate_interval])) by (service)",
            "legendFormat": "{{ service }}",
            "refId": "A"
          }
        ],
        "yAxes": [
          {
            "label": "Requests/sec",
            "format": "reqps",
            "decimals": 1
          }
        ]
      },
      {
        "id": 10,
        "title": "Error Budget Burn Timeline (30 days)",
        "type": "graph",
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 12,
          "y": 31
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "((0.005 - (sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[1d])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[1d])) by (service))) / 0.005) * 100",
            "legendFormat": "{{ service }}",
            "refId": "A"
          }
        ],
        "timeFrom": "30d",
        "yAxes": [
          {
            "label": "Error Budget %",
            "format": "percent",
            "min": 0,
            "max": 100
          }
        ],
        "thresholds": [
          {
            "value": 25,
            "colorMode": "critical"
          },
          {
            "value": 50,
            "colorMode": "warning"
          }
        ]
      },
      {
        "id": 11,
        "title": "SLO Violation Events (Last 7 days)",
        "type": "table",
        "gridPos": {
          "h": 10,
          "w": 24,
          "x": 0,
          "y": 39
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "changes((sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[5m])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[5m])) by (service) > 0.005)[7d:5m])",
            "format": "table",
            "instant": false,
            "refId": "A"
          }
        ],
        "transformations": [
          {
            "id": "organize",
            "options": {
              "renameByName": {
                "service": "Service",
                "Value": "Violation Count",
                "Time": "Last Violation"
              }
            }
          }
        ],
        "fieldConfig": {
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Service"
              },
              "properties": [
                {
                  "id": "links",
                  "value": [
                    {
                      "title": "View Runbook",
                      "url": "/docs/runbooks/${__value.text}.md"
                    },
                    {
                      "title": "View Service Dashboard",
                      "url": "/d/service-${__value.text}"
                    }
                  ]
                }
              ]
            }
          ]
        }
      },
      {
        "id": 12,
        "title": "Availability Heatmap (24h x 7d)",
        "type": "heatmap",
        "gridPos": {
          "h": 10,
          "w": 24,
          "x": 0,
          "y": 49
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "(1 - (sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[1h])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[1h])) by (service))) * 100",
            "format": "time_series",
            "refId": "A"
          }
        ],
        "options": {
          "calculate": true,
          "cellGap": 2,
          "color": {
            "mode": "scheme",
            "scheme": "RdYlGn"
          },
          "yAxis": {
            "unit": "percent",
            "decimals": 2,
            "min": 99.0,
            "max": 100.0
          }
        },
        "timeFrom": "7d"
      },
      {
        "id": 13,
        "title": "Current SLO Status Summary",
        "type": "stat",
        "gridPos": {
          "h": 8,
          "w": 6,
          "x": 0,
          "y": 59
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "count((1 - (sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[30d])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[30d])) by (service))) >= 0.995)",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {
                  "color": "red",
                  "value": null
                },
                {
                  "color": "yellow",
                  "value": 3
                },
                {
                  "color": "green",
                  "value": 5
                }
              ]
            }
          }
        },
        "options": {
          "textMode": "value_and_name",
          "colorMode": "background",
          "graphMode": "none"
        },
        "description": "Number of services meeting SLO (99.5%)"
      },
      {
        "id": 14,
        "title": "Services in Budget Crisis (<25%)",
        "type": "stat",
        "gridPos": {
          "h": 8,
          "w": 6,
          "x": 6,
          "y": 59
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "count(((0.005 - (sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[30d])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[30d])) by (service))) / 0.005) * 100 < 25)",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {
                  "color": "green",
                  "value": null
                },
                {
                  "color": "yellow",
                  "value": 1
                },
                {
                  "color": "red",
                  "value": 2
                }
              ]
            }
          }
        },
        "options": {
          "textMode": "value_and_name",
          "colorMode": "background",
          "graphMode": "none"
        },
        "description": "Services with less than 25% error budget remaining"
      },
      {
        "id": 15,
        "title": "Fast Burn Alerts (1h window)",
        "type": "stat",
        "gridPos": {
          "h": 8,
          "w": 6,
          "x": 12,
          "y": 59
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "count(((sum(rate(http_requests_total{service=~\"$service\",status=~\"5..\"}[1h])) by (service) / sum(rate(http_requests_total{service=~\"$service\"}[1h])) by (service)) / 0.005) > 14.4)",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {
                  "color": "green",
                  "value": null
                },
                {
                  "color": "orange",
                  "value": 1
                },
                {
                  "color": "red",
                  "value": 2
                }
              ]
            }
          }
        },
        "options": {
          "textMode": "value_and_name",
          "colorMode": "background",
          "graphMode": "none"
        },
        "description": "Services burning >14.4x error budget rate"
      },
      {
        "id": 16,
        "title": "Average P95 Latency",
        "type": "stat",
        "gridPos": {
          "h": 8,
          "w": 6,
          "x": 18,
          "y": 59
        },
        "targets": [
          {
            "datasource": "Prometheus",
            "expr": "avg(histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{service=~\"$service\"}[5m])) by (le, service))) * 1000",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "ms",
            "decimals": 0,
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {
                  "color": "green",
                  "value": null
                },
                {
                  "color": "yellow",
                  "value": 500
                },
                {
                  "color": "red",
                  "value": 1000
                }
              ]
            }
          }
        },
        "options": {
          "textMode": "value_and_name",
          "colorMode": "background",
          "graphMode": "area"
        },
        "description": "Platform-wide P95 latency"
      }
    ],
    "templating": {
      "list": [
        {
          "name": "service",
          "type": "query",
          "datasource": "Prometheus",
          "query": "label_values(http_requests_total, service)",
          "multi": true,
          "includeAll": true,
          "allValue": "api-gateway|reporting|q2q-ai|cockpit|impact-in",
          "refresh": 1,
          "current": {
            "text": "All",
            "value": "$__all"
          },
          "options": []
        },
        {
          "name": "slo_target",
          "type": "constant",
          "query": "99.5",
          "current": {
            "text": "99.5",
            "value": "99.5"
          },
          "description": "SLO availability target (%)"
        },
        {
          "name": "error_budget",
          "type": "constant",
          "query": "0.005",
          "current": {
            "text": "0.005",
            "value": "0.005"
          },
          "description": "Error budget (0.5%)"
        },
        {
          "name": "window",
          "type": "interval",
          "query": "1h,6h,1d,7d,30d",
          "auto": false,
          "current": {
            "text": "30d",
            "value": "30d"
          },
          "description": "SLO window"
        }
      ]
    },
    "time": {
      "from": "now-30d",
      "to": "now"
    },
    "timepicker": {
      "refresh_intervals": ["10s", "30s", "1m", "5m", "15m", "30m", "1h"],
      "time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "7d", "30d"]
    },
    "annotations": {
      "list": [
        {
          "datasource": "Prometheus",
          "enable": true,
          "expr": "changes(deployment_info{service=~\"$service\"}[5m]) > 0",
          "name": "Deployments",
          "titleFormat": "Deploy: {{ service }}",
          "tagKeys": "service,version",
          "iconColor": "blue"
        },
        {
          "datasource": "Prometheus",
          "enable": true,
          "expr": "ALERTS{alertname=~\"SLO.*\",service=~\"$service\"}",
          "name": "SLO Alerts",
          "titleFormat": "{{ alertname }}: {{ service }}",
          "iconColor": "red"
        },
        {
          "datasource": "Prometheus",
          "enable": true,
          "expr": "changes(incident_active{service=~\"$service\"}[5m]) > 0",
          "name": "Incidents",
          "titleFormat": "Incident: {{ service }} - {{ severity }}",
          "iconColor": "orange"
        }
      ]
    },
    "links": [
      {
        "title": "API Gateway Runbook",
        "url": "/docs/runbooks/api-gateway.md",
        "icon": "doc"
      },
      {
        "title": "Reporting Service Runbook",
        "url": "/docs/runbooks/reporting.md",
        "icon": "doc"
      },
      {
        "title": "Q2Q AI Runbook",
        "url": "/docs/runbooks/q2q-ai.md",
        "icon": "doc"
      },
      {
        "title": "Cockpit Runbook",
        "url": "/docs/runbooks/cockpit.md",
        "icon": "doc"
      },
      {
        "title": "Impact-In Runbook",
        "url": "/docs/runbooks/impact-in.md",
        "icon": "doc"
      },
      {
        "title": "SRE Playbook",
        "url": "/docs/sre-playbook.md",
        "icon": "book"
      },
      {
        "title": "Error Budget Policy",
        "url": "/docs/error-budget-policy.md",
        "icon": "shield"
      }
    ]
  }
}
